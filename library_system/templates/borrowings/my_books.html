{% extends 'base.html' %} {% load static %} {% block title %}–ú–æ–∏ –∫–Ω–∏–≥–∏
{%endblock %} {% block extra_css %}
<link rel="stylesheet" href="{% static 'css/borrowings.css' %}" />
{% endblock %} {% block content %}
<div class="container">
  <h1 class="page-title">üìñ –ú–æ–∏ –∫–Ω–∏–≥–∏</h1>

  {% if messages %} {% for message in messages %}
  <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  {% endfor %} {% endif %}

  <div class="section">
    <h2 class="section-title">üìö –¢–µ–∫—É—â–∏–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏—è</h2>

    {% if current_borrows %}
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th width="25%">–ö–Ω–∏–≥–∞</th>
            <th width="20%">–ê–≤—Ç–æ—Ä</th>
            <th width="15%">–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏</th>
            <th width="15%">–°—Ä–æ–∫ –≤–æ–∑–≤—Ä–∞—Ç–∞</th>
            <th width="15%">–°—Ç–∞—Ç—É—Å</th>
            <th width="10%">–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
        </thead>
        <tbody>
          {% for borrowing in current_borrows %}
          <tr>
            <td>
              <strong>{{ borrowing.book.title }}</strong><br />
              <small class="text-muted"
                >–ñ–∞–Ω—Ä: {{ borrowing.book.genre.name }}</small
              >
            </td>
            <td>{{ borrowing.book.author.name }}</td>
            <td class="text-center">
              {{ borrowing.borrowed_date|date:"d.m.Y" }}
            </td>
            <td class="text-center">{{ borrowing.due_date|date:"d.m.Y" }}</td>
            <td class="text-center">
              {% if borrowing.is_overdue %}
              <span class="badge badge-danger">
                ‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ<br />
                <small>{{ borrowing.days_overdue }} –¥–Ω.</small>
              </span>
              {% else %}
              <span class="badge badge-success">
                ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ<br />
                <small>{{ borrowing.days_until_due }} –¥–Ω.</small>
              </span>
              {% endif %}
            </td>
            <td class="text-center">
              <form
                method="post"
                action="{% url 'borrowings:return_book' borrowing.id %}"
                style="display: inline"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  class="btn btn-sm btn-return"
                  onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å –∫–Ω–∏–≥—É \u00AB{{ borrowing.book.title }}\u00BB?')"
                >
                  –í–µ—Ä–Ω—É—Ç—å
                </button>
              </form>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-book-open"></i>
      </div>
      <h3>–ù–µ—Ç —Ç–µ–∫—É—â–∏—Ö –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π</h3>
      <p>–£ –≤–∞—Å –Ω–µ—Ç –≤–∑—è—Ç—ã—Ö –∫–Ω–∏–≥ –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç</p>
      <a href="{% url 'books:book_list' %}" class="btn btn-primary">
        <i class="fas fa-search"></i> –ù–∞–π—Ç–∏ –∫–Ω–∏–≥–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
      </a>
    </div>
    {% endif %}
  </div>

  
  <div class="section">
    <h2 class="section-title">üìä –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π</h2>

    {% if borrow_history %}
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th width="30%">–ö–Ω–∏–≥–∞</th>
            <th width="25%">–ê–≤—Ç–æ—Ä</th>
            <th width="15%">–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏</th>
            <th width="15%">–î–∞—Ç–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞</th>
            <th width="15%">–°—Ç–∞—Ç—É—Å</th>
          </tr>
        </thead>
        <tbody>
          {% for borrowing in borrow_history %}
          <tr>
            <td>
              <strong>{{ borrowing.book.title }}</strong><br />
              <small class="text-muted"
                >–ñ–∞–Ω—Ä: {{ borrowing.book.genre.name }}</small
              >
            </td>
            <td>{{ borrowing.book.author.name }}</td>
            <td class="text-center">
              {{ borrowing.borrowed_date|date:"d.m.Y" }}
            </td>
            <td class="text-center">
              {{ borrowing.returned_date|date:"d.m.Y" }}
            </td>
            <td class="text-center">
              <span class="badge badge-secondary"> üìö –í–æ–∑–≤—Ä–∞—â–µ–Ω–∞ </span>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-history"></i>
      </div>
      <h3>–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</h3>
      <p>–ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∏—Å—Ç–æ—Ä–∏—è –≤–∞—à–∏—Ö –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–π</p>
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
