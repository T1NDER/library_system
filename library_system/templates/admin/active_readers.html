{% extends "admin/base_site.html" %}
{% load static %}

{% block extrastyle %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/admin_reports.css' %}">
{% endblock %}

{% block title %}–ê–∫—Ç–∏–≤–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏ | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block branding %}
<h1 id="site-name"><a href="{% url 'admin:index' %}">üë• –ê–∫—Ç–∏–≤–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏</a></h1>
{% endblock %}

{% block content_title %}<h1>–ê–∫—Ç–∏–≤–Ω—ã–µ —á–∏—Ç–∞—Ç–µ–ª–∏</h1>{% endblock %}

{% block content %}
<div class="admin-report">
    <div class="report-section">
        <h2>–¢–æ–ø-20 –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∏—Ç–∞—Ç–µ–ª–µ–π</h2>
        <table class="report-table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>–ß–∏—Ç–∞—Ç–µ–ª—å</th>
                    <th>–í—Å–µ–≥–æ –≤—ã–¥–∞—á</th>
                    <th>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–π–º—ã</th>
                    <th>–†–æ–ª—å</th>
                </tr>
            </thead>
            <tbody>
                {% for reader in active_readers %}
                <tr>
                    <td class="rank">{{ forloop.counter }}</td>
                    <td><strong>{{ reader.get_full_name|default:reader.username }}</strong></td>
                    <td><span class="count-badge">{{ reader.borrow_count }}</span></td>
                    <td>
                        {% if reader.active_borrowings > 0 %}
                            <span class="active-badge">{{ reader.active_borrowings }}</span>
                        {% else %}
                            <span class="inactive-badge">0</span>
                        {% endif %}
                    </td>
                    <td><span class="role-badge">{{ reader.get_role_display }}</span></td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="no-data">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∏—Ç–∞—Ç–µ–ª–µ–π</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="stats-grid">
        <div class="report-section">
            <h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–æ–ª—è–º</h2>
            <table class="report-table">
                <thead>
                    <tr>
                        <th>–†–æ–ª—å</th>
                        <th>–ê–∫—Ç–∏–≤–Ω—ã—Ö</th>
                        <th>–í—Å–µ–≥–æ</th>
                        <th>–í—ã–¥–∞—á</th>
                    </tr>
                </thead>
                <tbody>
                    {% for stat in role_stats %}
                    <tr>
                        <td>{{ stat.role }}</td>
                        <td><span class="count-badge">{{ stat.active_readers }}</span></td>
                        <td>{{ stat.total_users }}</td>
                        <td>{{ stat.total_borrowings }}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —Ä–æ–ª—è–º</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="report-section">
            <h2>‚ö†Ô∏è –ß–∏—Ç–∞—Ç–µ–ª–∏ —Å –ø—Ä–æ—Å—Ä–æ—á–∫–∞–º–∏</h2>
            <table class="report-table">
                <thead>
                    <tr>
                        <th>–ß–∏—Ç–∞—Ç–µ–ª—å</th>
                        <th>–ü—Ä–æ—Å—Ä–æ—á–µ–∫</th>
                    </tr>
                </thead>
                <tbody>
                    {% for reader in readers_with_overdue %}
                    <tr>
                        <td><strong>{{ reader.get_full_name|default:reader.username }}</strong></td>
                        <td><span class="overdue-badge">{{ reader.overdue_count }}</span></td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="2" class="no-data">–ù–µ—Ç —á–∏—Ç–∞—Ç–µ–ª–µ–π —Å –ø—Ä–æ—Å—Ä–æ—á–∫–∞–º–∏</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}